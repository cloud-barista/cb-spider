#!/bin/bash

source ../header.sh


echo -e "\n============ STEP-1: CREATE CONNECT CONFIG (AWS:OHIO)"

source ./setup.env

# for Cloud Driver Info
time $CLIPATH/spctl -u "$API_USERNAME" -p "$API_PASSWORD" driver register -d \
    '{
      "DriverName":"aws-driver01",
      "ProviderName":"AWS",
      "DriverLibFileName":"aws-driver-v1.0.so"
    }'

 # for Cloud Credential Info
time $CLIPATH/spctl -u "$API_USERNAME" -p "$API_PASSWORD" credential register -d \
    '{
      "CredentialName":"aws-credential01", 
      "ProviderName":"AWS",
      "KeyValueInfoList": [
        {"Key":"ClientId", "Value":"xxxxxxxxxxxx"},
        {"Key":"ClientSecret", "Value":"xxxxxxxxxxxx"}
      ]
    }'

 # for Cloud Region Info
time $CLIPATH/spctl -u "$API_USERNAME" -p "$API_PASSWORD" region register -d \
    '{
      "RegionName":"aws-ohio",
      "ProviderName":"AWS",
      "KeyValueInfoList": [
        {"Key":"Region", "Value":"us-east-2"},
        {"Key":"Zone", "Value":"us-east-2a"}
      ]
    }'

 # for Cloud Connection Config Info
time $CLIPATH/spctl -u "$API_USERNAME" -p "$API_PASSWORD" connection create -d \
    '{
      "ConfigName":"aws-ohio-config",
      "ProviderName":"AWS",
      "DriverName":"aws-driver01",
      "CredentialName":"aws-credential01",
      "RegionName":"aws-ohio"
    }'


source ../tailer.sh
